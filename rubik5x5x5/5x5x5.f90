MODULE RUBIK5

   INTEGER(4),PARAMETER :: N=100000
   INTEGER(4) :: LIST(1:144,1:N),SUBLIST(1:144,1:N),NEWLIST(1:144,1:N)
   INTEGER(4) :: ILIST,ISUB,INEW

END MODULE



PROGRAM RUBIK_5X5X5
! BLANKET ENUMERATION OF 5X5X5 RUBIK'S CUBE CONFIGURATIONS.
! SO HIRATA, UNIVERSITY OF ILLINOIS AT URBANA-CHAMPAIGN, JANUARY 2024.

   USE RUBIK5

   IMPLICIT NONE

   INTERFACE
      INTEGER FUNCTION IEXIST(CONFIG)
         INTEGER(4) :: CONFIG(1:144)
      END FUNCTION
   END INTERFACE

   INTEGER(4)  :: I,J,K
   REAL :: START,FINISH,START2,FINISH2
   INTEGER(4),PARAMETER :: MAXSTEPS=50
   INTEGER(4),PARAMETER :: ALGORITHM=2 ! 1 SORTED; 2 UNSORTED
   INTEGER(4) :: METRIC
!  INTEGER(4),PARAMETER :: METRIC=1 ! 1 QUARTER-TURN; 2 HALF-TURN; 3: SEMI-QUARTER-TURN METRIC; 4: TWO-QUARTER-TURN METRIC
   INTEGER(4) :: ICUBOID(1:144),JCUBOID(1:144),KCUBOID(1:144)
   INTEGER(4) :: ISTEP,JFOUND,ITURN,NTURN

   WRITE(6,'(A)') "5X5X5 RUBIK'S CUBE CONFIGURATION GENERATION"
!  WRITE(6,'(A)') '1: QUARTER-TURN METRIC; 2: HALF-TURN METRIC; 3: SEMI-QUARTER-TURN METRIC; 4: TWO-QUARTER-TURN METRIC'
   WRITE(6,'(A)') '1: QUARTER-TURN METRIC; 2: HALF-TURN METRIC'
   READ(5,*) METRIC
   IF (METRIC==1) THEN
    WRITE(6,'(A)') 'QUARTER-TURN METRIC'
   ELSE IF (METRIC==2) THEN
    WRITE(6,'(A)') 'HALF-TURN METRIC'
!  ELSE IF (METRIC==3) THEN
!   WRITE(6,'(A)') 'SEMI-QUARTER-TURN METRIC'
!  ELSE IF (METRIC==4) THEN
!   WRITE(6,'(A)') 'TWO-QUARTER-TURN METRIC'
   ELSE
    WRITE(6,'(A)') 'ILLEGAL METRIC'
    STOP
   ENDIF

   WRITE(6,'(A,I0)') 'MAX NUMBER OF CONFIGURATIONS = ',N

   LIST=0
   SUBLIST=0

   ! INITIAL CONFIGURATION
   ISTEP=0
   CALL INITIALIZE(ICUBOID)
   LIST(:,1)=ICUBOID(:)
   ILIST=1
   SUBLIST(:,1)=ICUBOID(:)
   ISUB=1
   INEW=0
   WRITE(6,'(3(A,I10))') 'STEP ',ISTEP,' NEW CONFIGS ',1,' CUMMULATIVE CONFIGS ',ILIST

   DO ISTEP=1,MAXSTEPS
    CALL CPU_TIME(START)
    CALL CPU_TIME(START2)
    NEWLIST=0
    INEW=0
    DO I=1,ISUB
     IF (ISUB > 100000) THEN
      IF (MOD(I,10000)==0) THEN
       CALL CPU_TIME(FINISH2)
       WRITE(6,'(A,I8,A,F20.3)') '    SEED CONFIGS ',I,' CPU TIME ',FINISH2-START2
       CALL CPU_TIME(START2)
      ENDIF
     ENDIF
     ICUBOID(:)=SUBLIST(:,I)
!    QUARTER-TURN METRIC
     IF (METRIC==1) THEN
      NTURN=24
      DO ITURN=1,NTURN
       IF (ITURN== 1) CALL R1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN== 2) CALL R1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN== 3) CALL D1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN== 4) CALL D1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN== 5) CALL B1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN== 6) CALL B1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN== 7) CALL L1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN== 8) CALL L1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN== 9) CALL U1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==10) CALL U1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==11) CALL F1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==12) CALL F1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==13) CALL R2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==14) CALL R2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==15) CALL D2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==16) CALL D2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==17) CALL B2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==18) CALL B2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==19) CALL L2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==20) CALL L2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==21) CALL U2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==22) CALL U2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==23) CALL F2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==24) CALL F2(ICUBOID,JCUBOID,.FALSE.)
       JFOUND=IEXIST(JCUBOID)
       IF (JFOUND==0) THEN
        ILIST=ILIST+1
        IF (ILIST > N) THEN
         WRITE(6,'(A)') 'ERROR 2'
         STOP
        ENDIF
        LIST(:,ILIST)=JCUBOID(:)
        INEW=INEW+1
        IF (INEW > N) THEN
         WRITE(6,'(A)') 'ERROR 3'
         STOP
        ENDIF
        NEWLIST(:,INEW)=JCUBOID(:)
       ENDIF 
      ENDDO
!    HALF-TURN METRIC
     ELSE IF (METRIC==2) THEN
      NTURN=36
      DO ITURN=1,NTURN
       IF (ITURN== 1) CALL R1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN== 2) CALL R1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN== 3) CALL D1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN== 4) CALL D1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN== 5) CALL B1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN== 6) CALL B1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN== 7) CALL L1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN== 8) CALL L1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN== 9) CALL U1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==10) CALL U1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==11) CALL F1(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==12) CALL F1(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==13) CALL R2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==14) CALL R2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==15) CALL D2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==16) CALL D2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==17) CALL B2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==18) CALL B2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==19) CALL L2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==20) CALL L2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==21) CALL U2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==22) CALL U2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==23) CALL F2(ICUBOID,JCUBOID,.TRUE.)
       IF (ITURN==24) CALL F2(ICUBOID,JCUBOID,.FALSE.)
       IF (ITURN==25) THEN
        CALL R1(ICUBOID,KCUBOID,.TRUE.)
        CALL R1(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==26) THEN
        CALL D1(ICUBOID,KCUBOID,.TRUE.)
        CALL D1(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==27) THEN
        CALL B1(ICUBOID,KCUBOID,.TRUE.)
        CALL B1(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==28) THEN
        CALL L1(ICUBOID,KCUBOID,.TRUE.)
        CALL L1(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==29) THEN
        CALL U1(ICUBOID,KCUBOID,.TRUE.)
        CALL U1(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==30) THEN
        CALL F1(ICUBOID,KCUBOID,.TRUE.)
        CALL F1(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==31) THEN
        CALL R2(ICUBOID,KCUBOID,.TRUE.)
        CALL R2(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==32) THEN
        CALL D2(ICUBOID,KCUBOID,.TRUE.)
        CALL D2(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==33) THEN
        CALL B2(ICUBOID,KCUBOID,.TRUE.)
        CALL B2(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==34) THEN
        CALL L2(ICUBOID,KCUBOID,.TRUE.)
        CALL L2(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==35) THEN
        CALL U2(ICUBOID,KCUBOID,.TRUE.)
        CALL U2(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       IF (ITURN==36) THEN
        CALL F2(ICUBOID,KCUBOID,.TRUE.)
        CALL F2(KCUBOID,JCUBOID,.TRUE.)
       ENDIF
       JFOUND=IEXIST(JCUBOID)
       IF (JFOUND==0) THEN
        ILIST=ILIST+1
        IF (ILIST > N) THEN
         WRITE(6,'(A)') 'ERROR 5'
         STOP
        ENDIF
        LIST(:,ILIST)=JCUBOID(:)
        INEW=INEW+1
        IF (INEW > N) THEN
         WRITE(6,'(A)') 'ERROR 6'
         STOP
        ENDIF
        NEWLIST(:,INEW)=JCUBOID(:)
       ENDIF 
      ENDDO
     ENDIF
    ENDDO
    IF (INEW==0) THEN
     IF (ILIST==N) THEN
      EXIT
     ELSE
      WRITE(6,'(A,I0)') 'ILLEGAL TERMINATION WITH CUMMULATIVE CONFIGURATIONS ',ILIST
      EXIT
     ENDIF
    ENDIF
    CALL CPU_TIME(FINISH)
    WRITE(6,'(3(A,I10),A,F20.3)') 'STEP ',ISTEP,' NEW CONFIGS ',INEW,' CUMMULATIVE CONFIGS ',ILIST,' CPU TIME ',FINISH-START
    ISUB=INEW
    SUBLIST=NEWLIST
   ENDDO
   CALL CPU_TIME(FINISH)

END PROGRAM



SUBROUTINE INITIALIZE(ICUBOID)
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!

   IMPLICIT NONE
   INTEGER(4)  :: I,J
   INTEGER(4)  :: ICUBOID(1:144)

   DO I=1,6
    DO J=1,24
     ICUBOID((I-1)*24+J)=I
    ENDDO
   ENDDO
   WRITE(6,'(144I1)') (ICUBOID(I),I=1,144)

   RETURN

END SUBROUTINE



SUBROUTINE R1(ICUBOID,JCUBOID,LPRIME)
! PERFORM RIGHT-1 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID(101)=ICUBOID(  5)
    JCUBOID(106)=ICUBOID( 10)
    JCUBOID(110)=ICUBOID( 14)
    JCUBOID(115)=ICUBOID( 19)
    JCUBOID(120)=ICUBOID( 24)

    JCUBOID(140)=ICUBOID(101)
    JCUBOID(135)=ICUBOID(106)
    JCUBOID(131)=ICUBOID(110)
    JCUBOID(126)=ICUBOID(115)
    JCUBOID(121)=ICUBOID(120)

    JCUBOID( 53)=ICUBOID(140)
    JCUBOID( 58)=ICUBOID(135)
    JCUBOID( 62)=ICUBOID(131)
    JCUBOID( 67)=ICUBOID(126)
    JCUBOID( 72)=ICUBOID(121)

    JCUBOID(  5)=ICUBOID( 53)
    JCUBOID( 10)=ICUBOID( 58)
    JCUBOID( 14)=ICUBOID( 62)
    JCUBOID( 19)=ICUBOID( 67)
    JCUBOID( 24)=ICUBOID( 72)

    JCUBOID( 29)=ICUBOID( 25)
    JCUBOID( 34)=ICUBOID( 26)
    JCUBOID( 38)=ICUBOID( 27)
    JCUBOID( 43)=ICUBOID( 28)

    JCUBOID( 48)=ICUBOID( 29)
    JCUBOID( 47)=ICUBOID( 34)
    JCUBOID( 46)=ICUBOID( 38)
    JCUBOID( 45)=ICUBOID( 43)

    JCUBOID( 44)=ICUBOID( 48)
    JCUBOID( 39)=ICUBOID( 47)
    JCUBOID( 35)=ICUBOID( 46)
    JCUBOID( 30)=ICUBOID( 45)

    JCUBOID( 25)=ICUBOID( 44)
    JCUBOID( 26)=ICUBOID( 39)
    JCUBOID( 27)=ICUBOID( 35)
    JCUBOID( 28)=ICUBOID( 30)

    JCUBOID( 33)=ICUBOID( 31)
    JCUBOID( 37)=ICUBOID( 32)
    JCUBOID( 42)=ICUBOID( 33)
    JCUBOID( 41)=ICUBOID( 37)
    JCUBOID( 40)=ICUBOID( 42)
    JCUBOID( 36)=ICUBOID( 41)
    JCUBOID( 31)=ICUBOID( 40)
    JCUBOID( 32)=ICUBOID( 36)
   ELSE
    JCUBOID(  5)=ICUBOID(101)
    JCUBOID( 10)=ICUBOID(106)
    JCUBOID( 14)=ICUBOID(110)
    JCUBOID( 19)=ICUBOID(115)
    JCUBOID( 24)=ICUBOID(120)
                            
    JCUBOID(101)=ICUBOID(140)
    JCUBOID(106)=ICUBOID(135)
    JCUBOID(110)=ICUBOID(131)
    JCUBOID(115)=ICUBOID(126)
    JCUBOID(120)=ICUBOID(121)
                            
    JCUBOID(140)=ICUBOID( 53)
    JCUBOID(135)=ICUBOID( 58)
    JCUBOID(131)=ICUBOID( 62)
    JCUBOID(126)=ICUBOID( 67)
    JCUBOID(121)=ICUBOID( 72)
                            
    JCUBOID( 53)=ICUBOID(  5)
    JCUBOID( 58)=ICUBOID( 10)
    JCUBOID( 62)=ICUBOID( 14)
    JCUBOID( 67)=ICUBOID( 19)
    JCUBOID( 72)=ICUBOID( 24)
                            
    JCUBOID( 25)=ICUBOID( 29)
    JCUBOID( 26)=ICUBOID( 34)
    JCUBOID( 27)=ICUBOID( 38)
    JCUBOID( 28)=ICUBOID( 43)
                            
    JCUBOID( 29)=ICUBOID( 48)
    JCUBOID( 34)=ICUBOID( 47)
    JCUBOID( 38)=ICUBOID( 46)
    JCUBOID( 43)=ICUBOID( 45)
                            
    JCUBOID( 48)=ICUBOID( 44)
    JCUBOID( 47)=ICUBOID( 39)
    JCUBOID( 46)=ICUBOID( 35)
    JCUBOID( 45)=ICUBOID( 30)
                            
    JCUBOID( 44)=ICUBOID( 25)
    JCUBOID( 39)=ICUBOID( 26)
    JCUBOID( 35)=ICUBOID( 27)
    JCUBOID( 30)=ICUBOID( 28)
                            
    JCUBOID( 31)=ICUBOID( 33)
    JCUBOID( 32)=ICUBOID( 37)
    JCUBOID( 33)=ICUBOID( 42)
    JCUBOID( 37)=ICUBOID( 41)
    JCUBOID( 42)=ICUBOID( 40)
    JCUBOID( 41)=ICUBOID( 36)
    JCUBOID( 40)=ICUBOID( 31)
    JCUBOID( 36)=ICUBOID( 32)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE R2(ICUBOID,JCUBOID,LPRIME)
! PERFORM RIGHT-2 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID(100)=ICUBOID(  4)
    JCUBOID(105)=ICUBOID(  9)
    JCUBOID(109)=ICUBOID( 13)
    JCUBOID(114)=ICUBOID( 18)
    JCUBOID(119)=ICUBOID( 23)

    JCUBOID(141)=ICUBOID(100)
    JCUBOID(136)=ICUBOID(105)
    JCUBOID(132)=ICUBOID(109)
    JCUBOID(127)=ICUBOID(114)
    JCUBOID(122)=ICUBOID(119)

    JCUBOID( 52)=ICUBOID(141)
    JCUBOID( 57)=ICUBOID(136)
    JCUBOID( 61)=ICUBOID(132)
    JCUBOID( 66)=ICUBOID(127)
    JCUBOID( 71)=ICUBOID(122)

    JCUBOID(  4)=ICUBOID( 52)
    JCUBOID(  9)=ICUBOID( 57)
    JCUBOID( 13)=ICUBOID( 61)
    JCUBOID( 18)=ICUBOID( 66)
    JCUBOID( 23)=ICUBOID( 71)
   ELSE
    JCUBOID(  4)=ICUBOID(100)
    JCUBOID(  9)=ICUBOID(105)
    JCUBOID( 13)=ICUBOID(109)
    JCUBOID( 18)=ICUBOID(114)
    JCUBOID( 23)=ICUBOID(119)
                            
    JCUBOID(100)=ICUBOID(141)
    JCUBOID(105)=ICUBOID(136)
    JCUBOID(109)=ICUBOID(132)
    JCUBOID(114)=ICUBOID(127)
    JCUBOID(119)=ICUBOID(122)
                            
    JCUBOID(141)=ICUBOID( 52)
    JCUBOID(136)=ICUBOID( 57)
    JCUBOID(132)=ICUBOID( 61)
    JCUBOID(127)=ICUBOID( 66)
    JCUBOID(122)=ICUBOID( 71)
                            
    JCUBOID( 52)=ICUBOID(  4)
    JCUBOID( 57)=ICUBOID(  9)
    JCUBOID( 61)=ICUBOID( 13)
    JCUBOID( 66)=ICUBOID( 18)
    JCUBOID( 71)=ICUBOID( 23)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE L1(ICUBOID,JCUBOID,LPRIME)
! PERFORM LEFT-1 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 49)=ICUBOID(  1)
    JCUBOID( 54)=ICUBOID(  6)
    JCUBOID( 59)=ICUBOID( 11)
    JCUBOID( 63)=ICUBOID( 15)
    JCUBOID( 68)=ICUBOID( 20)

    JCUBOID(144)=ICUBOID( 49)
    JCUBOID(139)=ICUBOID( 54)
    JCUBOID(134)=ICUBOID( 59)
    JCUBOID(130)=ICUBOID( 63)
    JCUBOID(125)=ICUBOID( 68)

    JCUBOID( 97)=ICUBOID(144)
    JCUBOID(102)=ICUBOID(139)
    JCUBOID(107)=ICUBOID(134)
    JCUBOID(111)=ICUBOID(130)
    JCUBOID(116)=ICUBOID(125)

    JCUBOID(  1)=ICUBOID( 97)
    JCUBOID(  6)=ICUBOID(102)
    JCUBOID( 11)=ICUBOID(107)
    JCUBOID( 15)=ICUBOID(111)
    JCUBOID( 20)=ICUBOID(116)

    JCUBOID( 77)=ICUBOID( 73)
    JCUBOID( 82)=ICUBOID( 74)
    JCUBOID( 86)=ICUBOID( 75)
    JCUBOID( 91)=ICUBOID( 76)

    JCUBOID( 96)=ICUBOID( 77)
    JCUBOID( 95)=ICUBOID( 82)
    JCUBOID( 94)=ICUBOID( 86)
    JCUBOID( 93)=ICUBOID( 91)

    JCUBOID( 92)=ICUBOID( 96)
    JCUBOID( 87)=ICUBOID( 95)
    JCUBOID( 83)=ICUBOID( 94)
    JCUBOID( 78)=ICUBOID( 93)

    JCUBOID( 73)=ICUBOID( 92)
    JCUBOID( 74)=ICUBOID( 87)
    JCUBOID( 75)=ICUBOID( 83)
    JCUBOID( 76)=ICUBOID( 78)

    JCUBOID( 81)=ICUBOID( 79)
    JCUBOID( 85)=ICUBOID( 80)
    JCUBOID( 90)=ICUBOID( 81)
    JCUBOID( 89)=ICUBOID( 85)
    JCUBOID( 88)=ICUBOID( 90)
    JCUBOID( 84)=ICUBOID( 89)
    JCUBOID( 79)=ICUBOID( 88)
    JCUBOID( 80)=ICUBOID( 84)
   ELSE
    JCUBOID(  1)=ICUBOID( 49)
    JCUBOID(  6)=ICUBOID( 54)
    JCUBOID( 11)=ICUBOID( 59)
    JCUBOID( 15)=ICUBOID( 63)
    JCUBOID( 20)=ICUBOID( 68)
                            
    JCUBOID( 49)=ICUBOID(144)
    JCUBOID( 54)=ICUBOID(139)
    JCUBOID( 59)=ICUBOID(134)
    JCUBOID( 63)=ICUBOID(130)
    JCUBOID( 68)=ICUBOID(125)
                            
    JCUBOID(144)=ICUBOID( 97)
    JCUBOID(139)=ICUBOID(102)
    JCUBOID(134)=ICUBOID(107)
    JCUBOID(130)=ICUBOID(111)
    JCUBOID(125)=ICUBOID(116)
                            
    JCUBOID( 97)=ICUBOID(  1)
    JCUBOID(102)=ICUBOID(  6)
    JCUBOID(107)=ICUBOID( 11)
    JCUBOID(111)=ICUBOID( 15)
    JCUBOID(116)=ICUBOID( 20)
                            
    JCUBOID( 73)=ICUBOID( 77)
    JCUBOID( 74)=ICUBOID( 82)
    JCUBOID( 75)=ICUBOID( 86)
    JCUBOID( 76)=ICUBOID( 91)
                            
    JCUBOID( 77)=ICUBOID( 96)
    JCUBOID( 82)=ICUBOID( 95)
    JCUBOID( 86)=ICUBOID( 94)
    JCUBOID( 91)=ICUBOID( 93)
                            
    JCUBOID( 96)=ICUBOID( 92)
    JCUBOID( 95)=ICUBOID( 87)
    JCUBOID( 94)=ICUBOID( 83)
    JCUBOID( 93)=ICUBOID( 78)
                            
    JCUBOID( 92)=ICUBOID( 73)
    JCUBOID( 87)=ICUBOID( 74)
    JCUBOID( 83)=ICUBOID( 75)
    JCUBOID( 78)=ICUBOID( 76)
                            
    JCUBOID( 79)=ICUBOID( 81)
    JCUBOID( 80)=ICUBOID( 85)
    JCUBOID( 81)=ICUBOID( 90)
    JCUBOID( 85)=ICUBOID( 89)
    JCUBOID( 90)=ICUBOID( 88)
    JCUBOID( 89)=ICUBOID( 84)
    JCUBOID( 88)=ICUBOID( 79)
    JCUBOID( 84)=ICUBOID( 80)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE L2(ICUBOID,JCUBOID,LPRIME)
! PERFORM LEFT-2 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 50)=ICUBOID(  2)
    JCUBOID( 55)=ICUBOID(  7)
    JCUBOID( 60)=ICUBOID( 12)
    JCUBOID( 64)=ICUBOID( 16)
    JCUBOID( 69)=ICUBOID( 21)
               
    JCUBOID(143)=ICUBOID( 50)
    JCUBOID(138)=ICUBOID( 55)
    JCUBOID(133)=ICUBOID( 60)
    JCUBOID(129)=ICUBOID( 64)
    JCUBOID(124)=ICUBOID( 69)
               
    JCUBOID( 98)=ICUBOID(143)
    JCUBOID(103)=ICUBOID(138)
    JCUBOID(108)=ICUBOID(133)
    JCUBOID(112)=ICUBOID(129)
    JCUBOID(117)=ICUBOID(124)

    JCUBOID(  2)=ICUBOID( 98)
    JCUBOID(  7)=ICUBOID(103)
    JCUBOID( 12)=ICUBOID(108)
    JCUBOID( 16)=ICUBOID(112)
    JCUBOID( 21)=ICUBOID(117)
   ELSE
    JCUBOID(  2)=ICUBOID( 50)
    JCUBOID(  7)=ICUBOID( 55)
    JCUBOID( 12)=ICUBOID( 60)
    JCUBOID( 16)=ICUBOID( 64)
    JCUBOID( 21)=ICUBOID( 69)
                            
    JCUBOID( 50)=ICUBOID(143)
    JCUBOID( 55)=ICUBOID(138)
    JCUBOID( 60)=ICUBOID(133)
    JCUBOID( 64)=ICUBOID(129)
    JCUBOID( 69)=ICUBOID(124)
                            
    JCUBOID(143)=ICUBOID( 98)
    JCUBOID(138)=ICUBOID(103)
    JCUBOID(133)=ICUBOID(108)
    JCUBOID(129)=ICUBOID(112)
    JCUBOID(124)=ICUBOID(117)
                            
    JCUBOID( 98)=ICUBOID(  2)
    JCUBOID(103)=ICUBOID(  7)
    JCUBOID(108)=ICUBOID( 12)
    JCUBOID(112)=ICUBOID( 16)
    JCUBOID(117)=ICUBOID( 21)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE U1(ICUBOID,JCUBOID,LPRIME)
! PERFORM UP-1 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 73)=ICUBOID(  1)
    JCUBOID( 74)=ICUBOID(  2)
    JCUBOID( 75)=ICUBOID(  3)
    JCUBOID( 76)=ICUBOID(  4)
    JCUBOID( 77)=ICUBOID(  5)

    JCUBOID(121)=ICUBOID( 73)
    JCUBOID(122)=ICUBOID( 74)
    JCUBOID(123)=ICUBOID( 75)
    JCUBOID(124)=ICUBOID( 76)
    JCUBOID(125)=ICUBOID( 77)

    JCUBOID( 25)=ICUBOID(121)
    JCUBOID( 26)=ICUBOID(122)
    JCUBOID( 27)=ICUBOID(123)
    JCUBOID( 28)=ICUBOID(124)
    JCUBOID( 29)=ICUBOID(125)

    JCUBOID(  1)=ICUBOID( 25)
    JCUBOID(  2)=ICUBOID( 26)
    JCUBOID(  3)=ICUBOID( 27)
    JCUBOID(  4)=ICUBOID( 28)
    JCUBOID(  5)=ICUBOID( 29)

    JCUBOID(101)=ICUBOID( 97)
    JCUBOID(106)=ICUBOID( 98)
    JCUBOID(110)=ICUBOID( 99)
    JCUBOID(115)=ICUBOID(100)
               
    JCUBOID(120)=ICUBOID(101)
    JCUBOID(119)=ICUBOID(106)
    JCUBOID(118)=ICUBOID(110)
    JCUBOID(117)=ICUBOID(115)
               
    JCUBOID(116)=ICUBOID(120)
    JCUBOID(111)=ICUBOID(119)
    JCUBOID(107)=ICUBOID(118)
    JCUBOID(102)=ICUBOID(117)

    JCUBOID( 97)=ICUBOID(116)
    JCUBOID( 98)=ICUBOID(111)
    JCUBOID( 99)=ICUBOID(107)
    JCUBOID(100)=ICUBOID(102)

    JCUBOID(105)=ICUBOID(103)
    JCUBOID(109)=ICUBOID(104)
    JCUBOID(114)=ICUBOID(105)
    JCUBOID(113)=ICUBOID(109)
    JCUBOID(112)=ICUBOID(114)
    JCUBOID(108)=ICUBOID(113)
    JCUBOID(103)=ICUBOID(112)
    JCUBOID(104)=ICUBOID(108)
   ELSE
    JCUBOID(  1)=ICUBOID( 73)
    JCUBOID(  2)=ICUBOID( 74)
    JCUBOID(  3)=ICUBOID( 75)
    JCUBOID(  4)=ICUBOID( 76)
    JCUBOID(  5)=ICUBOID( 77)
                            
    JCUBOID( 73)=ICUBOID(121)
    JCUBOID( 74)=ICUBOID(122)
    JCUBOID( 75)=ICUBOID(123)
    JCUBOID( 76)=ICUBOID(124)
    JCUBOID( 77)=ICUBOID(125)
                            
    JCUBOID(121)=ICUBOID( 25)
    JCUBOID(122)=ICUBOID( 26)
    JCUBOID(123)=ICUBOID( 27)
    JCUBOID(124)=ICUBOID( 28)
    JCUBOID(125)=ICUBOID( 29)
                            
    JCUBOID( 25)=ICUBOID(  1)
    JCUBOID( 26)=ICUBOID(  2)
    JCUBOID( 27)=ICUBOID(  3)
    JCUBOID( 28)=ICUBOID(  4)
    JCUBOID( 29)=ICUBOID(  5)
                            
    JCUBOID( 97)=ICUBOID(101)
    JCUBOID( 98)=ICUBOID(106)
    JCUBOID( 99)=ICUBOID(110)
    JCUBOID(100)=ICUBOID(115)
                            
    JCUBOID(101)=ICUBOID(120)
    JCUBOID(106)=ICUBOID(119)
    JCUBOID(110)=ICUBOID(118)
    JCUBOID(115)=ICUBOID(117)
                            
    JCUBOID(120)=ICUBOID(116)
    JCUBOID(119)=ICUBOID(111)
    JCUBOID(118)=ICUBOID(107)
    JCUBOID(117)=ICUBOID(102)
                            
    JCUBOID(116)=ICUBOID( 97)
    JCUBOID(111)=ICUBOID( 98)
    JCUBOID(107)=ICUBOID( 99)
    JCUBOID(102)=ICUBOID(100)
                            
    JCUBOID(103)=ICUBOID(105)
    JCUBOID(104)=ICUBOID(109)
    JCUBOID(105)=ICUBOID(114)
    JCUBOID(109)=ICUBOID(113)
    JCUBOID(114)=ICUBOID(112)
    JCUBOID(113)=ICUBOID(108)
    JCUBOID(112)=ICUBOID(103)
    JCUBOID(108)=ICUBOID(104)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE U2(ICUBOID,JCUBOID,LPRIME)
! PERFORM UP-2 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 78)=ICUBOID(  6)
    JCUBOID( 79)=ICUBOID(  7)
    JCUBOID( 80)=ICUBOID(  8)
    JCUBOID( 81)=ICUBOID(  9)
    JCUBOID( 82)=ICUBOID( 10)

    JCUBOID(126)=ICUBOID( 78)
    JCUBOID(127)=ICUBOID( 79)
    JCUBOID(128)=ICUBOID( 80)
    JCUBOID(129)=ICUBOID( 81)
    JCUBOID(130)=ICUBOID( 82)

    JCUBOID( 30)=ICUBOID(126)
    JCUBOID( 31)=ICUBOID(127)
    JCUBOID( 32)=ICUBOID(128)
    JCUBOID( 33)=ICUBOID(129)
    JCUBOID( 34)=ICUBOID(130)

    JCUBOID(  6)=ICUBOID( 30)
    JCUBOID(  7)=ICUBOID( 31)
    JCUBOID(  8)=ICUBOID( 32)
    JCUBOID(  9)=ICUBOID( 33)
    JCUBOID( 10)=ICUBOID( 34)
   ELSE
    JCUBOID(  6)=ICUBOID( 78)
    JCUBOID(  7)=ICUBOID( 79)
    JCUBOID(  8)=ICUBOID( 80)
    JCUBOID(  9)=ICUBOID( 81)
    JCUBOID( 10)=ICUBOID( 82)
                            
    JCUBOID( 78)=ICUBOID(126)
    JCUBOID( 79)=ICUBOID(127)
    JCUBOID( 80)=ICUBOID(128)
    JCUBOID( 81)=ICUBOID(129)
    JCUBOID( 82)=ICUBOID(130)
                            
    JCUBOID(126)=ICUBOID( 30)
    JCUBOID(127)=ICUBOID( 31)
    JCUBOID(128)=ICUBOID( 32)
    JCUBOID(129)=ICUBOID( 33)
    JCUBOID(130)=ICUBOID( 34)
                            
    JCUBOID( 30)=ICUBOID(  6)
    JCUBOID( 31)=ICUBOID(  7)
    JCUBOID( 32)=ICUBOID(  8)
    JCUBOID( 33)=ICUBOID(  9)
    JCUBOID( 34)=ICUBOID( 10)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE D1(ICUBOID,JCUBOID,LPRIME)
! PERFORM DOWN-1 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 44)=ICUBOID( 20)
    JCUBOID( 45)=ICUBOID( 21)
    JCUBOID( 46)=ICUBOID( 22)
    JCUBOID( 47)=ICUBOID( 23)
    JCUBOID( 48)=ICUBOID( 24)
               
    JCUBOID(140)=ICUBOID( 44)
    JCUBOID(141)=ICUBOID( 45)
    JCUBOID(142)=ICUBOID( 46)
    JCUBOID(143)=ICUBOID( 47)
    JCUBOID(144)=ICUBOID( 48)
               
    JCUBOID( 92)=ICUBOID(140)
    JCUBOID( 93)=ICUBOID(141)
    JCUBOID( 94)=ICUBOID(142)
    JCUBOID( 95)=ICUBOID(143)
    JCUBOID( 96)=ICUBOID(144)

    JCUBOID( 20)=ICUBOID( 92)
    JCUBOID( 21)=ICUBOID( 93)
    JCUBOID( 22)=ICUBOID( 94)
    JCUBOID( 23)=ICUBOID( 95)
    JCUBOID( 24)=ICUBOID( 96)

    JCUBOID( 53)=ICUBOID( 49)
    JCUBOID( 58)=ICUBOID( 50)
    JCUBOID( 62)=ICUBOID( 51)
    JCUBOID( 67)=ICUBOID( 52)
               
    JCUBOID( 72)=ICUBOID( 53)
    JCUBOID( 71)=ICUBOID( 58)
    JCUBOID( 70)=ICUBOID( 62)
    JCUBOID( 69)=ICUBOID( 67)
               
    JCUBOID( 68)=ICUBOID( 72)
    JCUBOID( 63)=ICUBOID( 71)
    JCUBOID( 59)=ICUBOID( 70)
    JCUBOID( 54)=ICUBOID( 69)

    JCUBOID( 49)=ICUBOID( 68)
    JCUBOID( 50)=ICUBOID( 63)
    JCUBOID( 51)=ICUBOID( 59)
    JCUBOID( 52)=ICUBOID( 54)

    JCUBOID( 57)=ICUBOID( 55)
    JCUBOID( 61)=ICUBOID( 56)
    JCUBOID( 66)=ICUBOID( 57)
    JCUBOID( 65)=ICUBOID( 61)
    JCUBOID( 64)=ICUBOID( 66)
    JCUBOID( 60)=ICUBOID( 65)
    JCUBOID( 55)=ICUBOID( 64)
    JCUBOID( 56)=ICUBOID( 60)
   ELSE
    JCUBOID( 20)=ICUBOID( 44)
    JCUBOID( 21)=ICUBOID( 45)
    JCUBOID( 22)=ICUBOID( 46)
    JCUBOID( 23)=ICUBOID( 47)
    JCUBOID( 24)=ICUBOID( 48)
                            
    JCUBOID( 44)=ICUBOID(140)
    JCUBOID( 45)=ICUBOID(141)
    JCUBOID( 46)=ICUBOID(142)
    JCUBOID( 47)=ICUBOID(143)
    JCUBOID( 48)=ICUBOID(144)
                            
    JCUBOID(140)=ICUBOID( 92)
    JCUBOID(141)=ICUBOID( 93)
    JCUBOID(142)=ICUBOID( 94)
    JCUBOID(143)=ICUBOID( 95)
    JCUBOID(144)=ICUBOID( 96)
                            
    JCUBOID( 92)=ICUBOID( 20)
    JCUBOID( 93)=ICUBOID( 21)
    JCUBOID( 94)=ICUBOID( 22)
    JCUBOID( 95)=ICUBOID( 23)
    JCUBOID( 96)=ICUBOID( 24)
                            
    JCUBOID( 49)=ICUBOID( 53)
    JCUBOID( 50)=ICUBOID( 58)
    JCUBOID( 51)=ICUBOID( 62)
    JCUBOID( 52)=ICUBOID( 67)
                            
    JCUBOID( 53)=ICUBOID( 72)
    JCUBOID( 58)=ICUBOID( 71)
    JCUBOID( 62)=ICUBOID( 70)
    JCUBOID( 67)=ICUBOID( 69)
                            
    JCUBOID( 72)=ICUBOID( 68)
    JCUBOID( 71)=ICUBOID( 63)
    JCUBOID( 70)=ICUBOID( 59)
    JCUBOID( 69)=ICUBOID( 54)
                            
    JCUBOID( 68)=ICUBOID( 49)
    JCUBOID( 63)=ICUBOID( 50)
    JCUBOID( 59)=ICUBOID( 51)
    JCUBOID( 54)=ICUBOID( 52)
                            
    JCUBOID( 55)=ICUBOID( 57)
    JCUBOID( 56)=ICUBOID( 61)
    JCUBOID( 57)=ICUBOID( 66)
    JCUBOID( 61)=ICUBOID( 65)
    JCUBOID( 66)=ICUBOID( 64)
    JCUBOID( 65)=ICUBOID( 60)
    JCUBOID( 64)=ICUBOID( 55)
    JCUBOID( 60)=ICUBOID( 56)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE D2(ICUBOID,JCUBOID,LPRIME)
! PERFORM DOWN-2 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 39)=ICUBOID( 15)
    JCUBOID( 40)=ICUBOID( 16)
    JCUBOID( 41)=ICUBOID( 17)
    JCUBOID( 42)=ICUBOID( 18)
    JCUBOID( 43)=ICUBOID( 19)
               
    JCUBOID(135)=ICUBOID( 39)
    JCUBOID(136)=ICUBOID( 40)
    JCUBOID(137)=ICUBOID( 41)
    JCUBOID(138)=ICUBOID( 42)
    JCUBOID(139)=ICUBOID( 43)
               
    JCUBOID( 87)=ICUBOID(135)
    JCUBOID( 88)=ICUBOID(136)
    JCUBOID( 89)=ICUBOID(137)
    JCUBOID( 90)=ICUBOID(138)
    JCUBOID( 91)=ICUBOID(139)

    JCUBOID( 15)=ICUBOID( 87)
    JCUBOID( 16)=ICUBOID( 88)
    JCUBOID( 17)=ICUBOID( 89)
    JCUBOID( 18)=ICUBOID( 90)
    JCUBOID( 19)=ICUBOID( 91)
   ELSE
    JCUBOID( 15)=ICUBOID( 39)
    JCUBOID( 16)=ICUBOID( 40)
    JCUBOID( 17)=ICUBOID( 41)
    JCUBOID( 18)=ICUBOID( 42)
    JCUBOID( 19)=ICUBOID( 43)
                            
    JCUBOID( 39)=ICUBOID(135)
    JCUBOID( 40)=ICUBOID(136)
    JCUBOID( 41)=ICUBOID(137)
    JCUBOID( 42)=ICUBOID(138)
    JCUBOID( 43)=ICUBOID(139)
                            
    JCUBOID(135)=ICUBOID( 87)
    JCUBOID(136)=ICUBOID( 88)
    JCUBOID(137)=ICUBOID( 89)
    JCUBOID(138)=ICUBOID( 90)
    JCUBOID(139)=ICUBOID( 91)
                            
    JCUBOID( 87)=ICUBOID( 15)
    JCUBOID( 88)=ICUBOID( 16)
    JCUBOID( 89)=ICUBOID( 17)
    JCUBOID( 90)=ICUBOID( 18)
    JCUBOID( 91)=ICUBOID( 19)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE F1(ICUBOID,JCUBOID,LPRIME)
! PERFORM FRONT-1 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 25)=ICUBOID(116)
    JCUBOID( 30)=ICUBOID(117)
    JCUBOID( 35)=ICUBOID(118)
    JCUBOID( 39)=ICUBOID(119)
    JCUBOID( 44)=ICUBOID(120)
               
    JCUBOID( 53)=ICUBOID( 25)
    JCUBOID( 52)=ICUBOID( 30)
    JCUBOID( 51)=ICUBOID( 35)
    JCUBOID( 50)=ICUBOID( 39)
    JCUBOID( 49)=ICUBOID( 44)
               
    JCUBOID( 96)=ICUBOID( 53)
    JCUBOID( 91)=ICUBOID( 52)
    JCUBOID( 86)=ICUBOID( 51)
    JCUBOID( 82)=ICUBOID( 50)
    JCUBOID( 77)=ICUBOID( 49)

    JCUBOID(116)=ICUBOID( 96)
    JCUBOID(117)=ICUBOID( 91)
    JCUBOID(118)=ICUBOID( 86)
    JCUBOID(119)=ICUBOID( 82)
    JCUBOID(120)=ICUBOID( 77)

    JCUBOID(  5)=ICUBOID(  1)
    JCUBOID( 10)=ICUBOID(  2)
    JCUBOID( 14)=ICUBOID(  3)
    JCUBOID( 19)=ICUBOID(  4)
               
    JCUBOID( 24)=ICUBOID(  5)
    JCUBOID( 23)=ICUBOID( 10)
    JCUBOID( 22)=ICUBOID( 14)
    JCUBOID( 21)=ICUBOID( 19)
               
    JCUBOID( 20)=ICUBOID( 24)
    JCUBOID( 15)=ICUBOID( 23)
    JCUBOID( 11)=ICUBOID( 22)
    JCUBOID(  6)=ICUBOID( 21)

    JCUBOID(  1)=ICUBOID( 20)
    JCUBOID(  2)=ICUBOID( 15)
    JCUBOID(  3)=ICUBOID( 11)
    JCUBOID(  4)=ICUBOID(  6)

    JCUBOID(  9)=ICUBOID(  7)
    JCUBOID( 13)=ICUBOID(  8)
    JCUBOID( 18)=ICUBOID(  9)
    JCUBOID( 17)=ICUBOID( 13)
    JCUBOID( 16)=ICUBOID( 18)
    JCUBOID( 12)=ICUBOID( 17)
    JCUBOID(  7)=ICUBOID( 16)
    JCUBOID(  8)=ICUBOID( 12)
   ELSE
    JCUBOID(116)=ICUBOID( 25)
    JCUBOID(117)=ICUBOID( 30)
    JCUBOID(118)=ICUBOID( 35)
    JCUBOID(119)=ICUBOID( 39)
    JCUBOID(120)=ICUBOID( 44)
                            
    JCUBOID( 25)=ICUBOID( 53)
    JCUBOID( 30)=ICUBOID( 52)
    JCUBOID( 35)=ICUBOID( 51)
    JCUBOID( 39)=ICUBOID( 50)
    JCUBOID( 44)=ICUBOID( 49)
                            
    JCUBOID( 53)=ICUBOID( 96)
    JCUBOID( 52)=ICUBOID( 91)
    JCUBOID( 51)=ICUBOID( 86)
    JCUBOID( 50)=ICUBOID( 82)
    JCUBOID( 49)=ICUBOID( 77)
                            
    JCUBOID( 96)=ICUBOID(116)
    JCUBOID( 91)=ICUBOID(117)
    JCUBOID( 86)=ICUBOID(118)
    JCUBOID( 82)=ICUBOID(119)
    JCUBOID( 77)=ICUBOID(120)
                            
    JCUBOID(  1)=ICUBOID(  5)
    JCUBOID(  2)=ICUBOID( 10)
    JCUBOID(  3)=ICUBOID( 14)
    JCUBOID(  4)=ICUBOID( 19)
                         
    JCUBOID(  5)=ICUBOID( 24)
    JCUBOID( 10)=ICUBOID( 23)
    JCUBOID( 14)=ICUBOID( 22)
    JCUBOID( 19)=ICUBOID( 21)
                            
    JCUBOID( 24)=ICUBOID( 20)
    JCUBOID( 23)=ICUBOID( 15)
    JCUBOID( 22)=ICUBOID( 11)
    JCUBOID( 21)=ICUBOID(  6)
                            
    JCUBOID( 20)=ICUBOID(  1)
    JCUBOID( 15)=ICUBOID(  2)
    JCUBOID( 11)=ICUBOID(  3)
    JCUBOID(  6)=ICUBOID(  4)
                            
    JCUBOID(  7)=ICUBOID(  9)
    JCUBOID(  8)=ICUBOID( 13)
    JCUBOID(  9)=ICUBOID( 18)
    JCUBOID( 13)=ICUBOID( 17)
    JCUBOID( 18)=ICUBOID( 16)
    JCUBOID( 17)=ICUBOID( 12)
    JCUBOID( 16)=ICUBOID(  7)
    JCUBOID( 12)=ICUBOID(  8)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE F2(ICUBOID,JCUBOID,LPRIME)
! PERFORM FRONT-2 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 26)=ICUBOID(111)
    JCUBOID( 31)=ICUBOID(112)
    JCUBOID( 36)=ICUBOID(113)
    JCUBOID( 40)=ICUBOID(114)
    JCUBOID( 45)=ICUBOID(115)
               
    JCUBOID( 67)=ICUBOID( 26)
    JCUBOID( 66)=ICUBOID( 31)
    JCUBOID( 65)=ICUBOID( 36)
    JCUBOID( 64)=ICUBOID( 40)
    JCUBOID( 63)=ICUBOID( 45)
               
    JCUBOID( 93)=ICUBOID( 67)
    JCUBOID( 88)=ICUBOID( 66)
    JCUBOID( 84)=ICUBOID( 65)
    JCUBOID( 79)=ICUBOID( 64)
    JCUBOID( 74)=ICUBOID( 63)

    JCUBOID(111)=ICUBOID( 93)
    JCUBOID(112)=ICUBOID( 88)
    JCUBOID(113)=ICUBOID( 84)
    JCUBOID(114)=ICUBOID( 79)
    JCUBOID(115)=ICUBOID( 74)
   ELSE
    JCUBOID(111)=ICUBOID( 26)
    JCUBOID(112)=ICUBOID( 31)
    JCUBOID(113)=ICUBOID( 36)
    JCUBOID(114)=ICUBOID( 40)
    JCUBOID(115)=ICUBOID( 45)
                            
    JCUBOID( 26)=ICUBOID( 67)
    JCUBOID( 31)=ICUBOID( 66)
    JCUBOID( 36)=ICUBOID( 65)
    JCUBOID( 40)=ICUBOID( 64)
    JCUBOID( 45)=ICUBOID( 63)
                            
    JCUBOID( 67)=ICUBOID( 93)
    JCUBOID( 66)=ICUBOID( 88)
    JCUBOID( 65)=ICUBOID( 84)
    JCUBOID( 64)=ICUBOID( 79)
    JCUBOID( 63)=ICUBOID( 74)
                            
    JCUBOID( 93)=ICUBOID(111)
    JCUBOID( 88)=ICUBOID(112)
    JCUBOID( 84)=ICUBOID(113)
    JCUBOID( 79)=ICUBOID(114)
    JCUBOID( 74)=ICUBOID(115)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE B1(ICUBOID,JCUBOID,LPRIME)
! PERFORM BACK-1 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 92)=ICUBOID( 97)
    JCUBOID( 87)=ICUBOID( 98)
    JCUBOID( 83)=ICUBOID( 99)
    JCUBOID( 78)=ICUBOID(100)
    JCUBOID( 73)=ICUBOID(101)
               
    JCUBOID( 72)=ICUBOID( 92)
    JCUBOID( 71)=ICUBOID( 87)
    JCUBOID( 70)=ICUBOID( 83)
    JCUBOID( 69)=ICUBOID( 78)
    JCUBOID( 68)=ICUBOID( 73)
               
    JCUBOID( 29)=ICUBOID( 72)
    JCUBOID( 34)=ICUBOID( 71)
    JCUBOID( 38)=ICUBOID( 70)
    JCUBOID( 43)=ICUBOID( 69)
    JCUBOID( 48)=ICUBOID( 68)

    JCUBOID( 97)=ICUBOID( 29)
    JCUBOID( 98)=ICUBOID( 34)
    JCUBOID( 99)=ICUBOID( 38)
    JCUBOID(100)=ICUBOID( 43)
    JCUBOID(101)=ICUBOID( 48)

    JCUBOID(125)=ICUBOID(121)
    JCUBOID(130)=ICUBOID(122)
    JCUBOID(134)=ICUBOID(123)
    JCUBOID(139)=ICUBOID(124)
               
    JCUBOID(144)=ICUBOID(125)
    JCUBOID(143)=ICUBOID(130)
    JCUBOID(142)=ICUBOID(134)
    JCUBOID(141)=ICUBOID(139)
               
    JCUBOID(140)=ICUBOID(144)
    JCUBOID(135)=ICUBOID(143)
    JCUBOID(131)=ICUBOID(142)
    JCUBOID(126)=ICUBOID(141)

    JCUBOID(121)=ICUBOID(140)
    JCUBOID(122)=ICUBOID(135)
    JCUBOID(123)=ICUBOID(131)
    JCUBOID(124)=ICUBOID(126)

    JCUBOID(129)=ICUBOID(127)
    JCUBOID(133)=ICUBOID(128)
    JCUBOID(138)=ICUBOID(129)
    JCUBOID(137)=ICUBOID(133)
    JCUBOID(136)=ICUBOID(138)
    JCUBOID(132)=ICUBOID(137)
    JCUBOID(127)=ICUBOID(136)
    JCUBOID(128)=ICUBOID(132)
   ELSE
    JCUBOID( 97)=ICUBOID( 92)
    JCUBOID( 98)=ICUBOID( 87)
    JCUBOID( 99)=ICUBOID( 83)
    JCUBOID(100)=ICUBOID( 78)
    JCUBOID(101)=ICUBOID( 73)
                            
    JCUBOID( 92)=ICUBOID( 72)
    JCUBOID( 87)=ICUBOID( 71)
    JCUBOID( 83)=ICUBOID( 70)
    JCUBOID( 78)=ICUBOID( 69)
    JCUBOID( 73)=ICUBOID( 68)
                            
    JCUBOID( 72)=ICUBOID( 29)
    JCUBOID( 71)=ICUBOID( 34)
    JCUBOID( 70)=ICUBOID( 38)
    JCUBOID( 69)=ICUBOID( 43)
    JCUBOID( 68)=ICUBOID( 48)
                            
    JCUBOID( 29)=ICUBOID( 97)
    JCUBOID( 34)=ICUBOID( 98)
    JCUBOID( 38)=ICUBOID( 99)
    JCUBOID( 43)=ICUBOID(100)
    JCUBOID( 48)=ICUBOID(101)
                            
    JCUBOID(121)=ICUBOID(125)
    JCUBOID(122)=ICUBOID(130)
    JCUBOID(123)=ICUBOID(134)
    JCUBOID(124)=ICUBOID(139)
                            
    JCUBOID(125)=ICUBOID(144)
    JCUBOID(130)=ICUBOID(143)
    JCUBOID(134)=ICUBOID(142)
    JCUBOID(139)=ICUBOID(141)
                            
    JCUBOID(144)=ICUBOID(140)
    JCUBOID(143)=ICUBOID(135)
    JCUBOID(142)=ICUBOID(131)
    JCUBOID(141)=ICUBOID(126)
                            
    JCUBOID(140)=ICUBOID(121)
    JCUBOID(135)=ICUBOID(122)
    JCUBOID(131)=ICUBOID(123)
    JCUBOID(126)=ICUBOID(124)
                            
    JCUBOID(127)=ICUBOID(129)
    JCUBOID(128)=ICUBOID(133)
    JCUBOID(129)=ICUBOID(138)
    JCUBOID(133)=ICUBOID(137)
    JCUBOID(138)=ICUBOID(136)
    JCUBOID(137)=ICUBOID(132)
    JCUBOID(136)=ICUBOID(127)
    JCUBOID(132)=ICUBOID(128)
   ENDIF
   RETURN

END SUBROUTINE



SUBROUTINE B2(ICUBOID,JCUBOID,LPRIME)
! PERFORM BACK-2 LAYER ROTATE BY 90 DEGREES
!
!                     97  98  99  100 101
!                     102 103 104 105 106
!                     107 108 -U- 109 110
!                     111 112 113 114 115
!                     116 117 118 119 120
!                     -------------------
! 73  74  75  76  77 | 1   2   3   4   5 |25  26  27  28  29 |121 122 123 124 125  
! 78  79  80  81  82 | 6   7   8   9  10 |30  31  32  33  34 |126 127 128 129 130  
! 83  84  -L- 85  86 |11  12  -F- 13  14 |35  36  -R- 37  38 |131 132 -B- 133 134  
! 87  88  89  90  91 |15  16  17  18  19 |39  40  41  42  43 |135 136 137 138 139  
! 92  93  94  95  96 |20  21  22  23  24 |44  45  46  47  48 |140 141 142 143 144  
!                     -------------------
!                     49  50  51  52  53 
!                     54  55  56  57  58 
!                     59  60  -D- 61  62 
!                     63  64  65  66  67 
!                     68  69  70  71  72 
!
   IMPLICIT NONE
   INTEGER(4)  :: ICUBOID(1:144)
   INTEGER(4)  :: JCUBOID(1:144)
   LOGICAL     :: LPRIME ! TRUE CLOCKWISE; FALSE COUNTERCLOCKWISE

   JCUBOID=ICUBOID

   IF (LPRIME) THEN
    JCUBOID( 93)=ICUBOID(102)
    JCUBOID( 88)=ICUBOID(103)
    JCUBOID( 84)=ICUBOID(104)
    JCUBOID( 79)=ICUBOID(105)
    JCUBOID( 74)=ICUBOID(106)
               
    JCUBOID( 67)=ICUBOID( 93)
    JCUBOID( 66)=ICUBOID( 88)
    JCUBOID( 65)=ICUBOID( 84)
    JCUBOID( 64)=ICUBOID( 79)
    JCUBOID( 63)=ICUBOID( 74)
               
    JCUBOID( 28)=ICUBOID( 67)
    JCUBOID( 33)=ICUBOID( 66)
    JCUBOID( 37)=ICUBOID( 65)
    JCUBOID( 42)=ICUBOID( 64)
    JCUBOID( 47)=ICUBOID( 63)

    JCUBOID(102)=ICUBOID( 28)
    JCUBOID(103)=ICUBOID( 33)
    JCUBOID(104)=ICUBOID( 37)
    JCUBOID(105)=ICUBOID( 42)
    JCUBOID(106)=ICUBOID( 47)
   ELSE
    JCUBOID(102)=ICUBOID( 93)
    JCUBOID(103)=ICUBOID( 88)
    JCUBOID(104)=ICUBOID( 84)
    JCUBOID(105)=ICUBOID( 79)
    JCUBOID(106)=ICUBOID( 74)
                            
    JCUBOID( 93)=ICUBOID( 67)
    JCUBOID( 88)=ICUBOID( 66)
    JCUBOID( 84)=ICUBOID( 65)
    JCUBOID( 79)=ICUBOID( 64)
    JCUBOID( 74)=ICUBOID( 63)
                            
    JCUBOID( 67)=ICUBOID( 28)
    JCUBOID( 66)=ICUBOID( 33)
    JCUBOID( 65)=ICUBOID( 37)
    JCUBOID( 64)=ICUBOID( 42)
    JCUBOID( 63)=ICUBOID( 47)
                            
    JCUBOID( 28)=ICUBOID(102)
    JCUBOID( 33)=ICUBOID(103)
    JCUBOID( 37)=ICUBOID(104)
    JCUBOID( 42)=ICUBOID(105)
    JCUBOID( 47)=ICUBOID(106)
   ENDIF
   RETURN

END SUBROUTINE



INTEGER FUNCTION IEXIST(CONFIG)
! RETURN TRUE IF CONFIG EXISTS IN THE LIST

   USE RUBIK5

   INTEGER(4)  :: CONFIG(1:144)
   INTEGER(4)  :: I,J,K

   ! DEBUG
   IF (ILIST < 0) THEN
    K=0
    DO J=1,144
     K=K+CONFIG(J)
    ENDDO
    WRITE(6,'(A,144I1,I5)') 'CONFIG  =',(CONFIG(J),J=1,144),K
    WRITE(6,*) 'LIST=',ILIST
    DO I=1,ILIST
     WRITE(6,'(I3,X,144I1)') I,(LIST(J,I),J=1,144)
    ENDDO
   ENDIF

   IEXIST=0
   IF (ILIST==0) RETURN
   DO I=1,ILIST
    K=1
    DO J=1,144
     IF (CONFIG(J)/=LIST(J,I)) THEN
      K=0
      EXIT
     ENDIF
    ENDDO
    IF (K==1) THEN
     IEXIST=I
     EXIT
    ENDIF
   ENDDO
   IF (ILIST < 0) THEN
    IF (IEXIST==0) WRITE(6,'(A)') 'NOT EXIST'
    IF (IEXIST/=0) WRITE(6,'(A,I3,X,144I1)') 'EXIST',I,(LIST(J,I),J=1,144)
   ENDIF

   RETURN

END FUNCTION
